<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: AWS | function Blog() {};]]></title>
  <link href="http://lunchub.github.io/blog/categories/aws/atom.xml" rel="self"/>
  <link href="http://lunchub.github.io/"/>
  <updated>2013-07-14T17:27:30+09:00</updated>
  <id>http://lunchub.github.io/</id>
  <author>
    <name><![CDATA[Daisuke Masuyama]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[CarrierWaveでアップロード先をAmazon S3に設定する方法]]></title>
    <link href="http://lunchub.github.io/blog/2013/07/14/how-to-use-carrierwave-with-amazon-s3/"/>
    <updated>2013-07-14T17:25:00+09:00</updated>
    <id>http://lunchub.github.io/blog/2013/07/14/how-to-use-carrierwave-with-amazon-s3</id>
    <content type="html"><![CDATA[<h2>Environment</h2>

<p><code>
Mac OSX 10.7.5 (Lion)
ruby 1.9.3p392 (2013-02-22 revision 39386) [x86_64-darwin11.4.2]
Rails 3.2.13
[Gems]
  CarrierWave (0.8.0)
  fog (1.12.1)
</code></p>

<h2>Precondition</h2>

<ul>
<li><p><code>Amazon S3</code>を利用するためには，<code>Amazon Web Services (AWS)</code>への登録が必要です．</p>

<ul>
<li><a href="/blog/2013/07/13/how-to-register-for-aws/">AWSへの登録記事はこちら</a></li>
</ul>
</li>
<li><p><code>CarrierWave</code>の設定時に，<code>Amazon S3</code>のBucket情報が必要なため，Bucketが作成されていなければなりません．</p>

<ul>
<li><a href="/blog/2013/07/14/how-to-create-bucket-on-amazon-s3/">Amazon S3にBucketを作成する方法はこちら</a></li>
</ul>
</li>
</ul>


<h2>Issues</h2>

<p>CarrierWaveのアップロード先をAmazon S3に設定したい．</p>

<p>Herokuを使ってRailsアプリを運用しているものの, Herokuではファイルをサーバ上に保存することができないため，<br/>
画像アップロード等は別のサーバに行う必要があります．<br/>
そこで今回は，非常に低価格でクラウドストレージを扱うことのできる<code>Amazon S3</code>をアップロード先に指定しました．</p>

<h2>How to</h2>

<h3>Gemを追加する</h3>

<p><code>text Gemfile
gem "fog",  "~&gt; 1.3.1"
</code></p>

<h3>initializerを追加する</h3>

<p>ここに<code>Amazon S3</code>の情報を設定します．<br/>
``` ruby config/initializer/carrierwave.rb
CarrierWave.configure do |config|
  config.fog_credentials = {</p>

<pre><code>:provider               =&gt; 'AWS',   # required
:aws_access_key_id      =&gt; 'xxx',   # required
:aws_secret_access_key  =&gt; 'yyy',   # required
:region                 =&gt; 'tokyo', # optional,  defaults to 'us-east-1'
:host                   =&gt; '',      # optional,  defaults to nil
:endpoint               =&gt; ''       # optional,  defaults to nil
</code></pre>

<p>  }
  config.fog_directory  = &lsquo;myapp-carrierwave&rsquo;                # required
  config.fog_public     = false                              # optional,  defaults to true
  config.fog_attributes = {&lsquo;Cache-Control&rsquo;=>&lsquo;max-age=82800&rsquo;} # optional,  defaults to {}
end
```</p>

<ul>
<li><code>:region</code>の入力は任意ですが，'tokyo'リージョンを使用している場合は変更が必要です．</li>
<li><code>config.fog_directory</code>はBucketの名前です．</li>
<li><code>config.fog_public</code>は<code>false</code>に設定しておくことで，Rails経由でのアクセスしか<code>Amazon S3</code>上のファイルにアクセスできなくなります．</li>
</ul>


<h3>Uploaderクラスのプロパティ値を変更する</h3>

<p>``` ruby APP_ROOT_PATH/app/uploaders/image_uploader.rb</p>

<h1>encoding: utf-8</h1>

<p>class ImageUploader &lt; CarrierWave::Uploader::Base
  # storage :file
  storage :fog
end
```</p>

<h2>References</h2>

<p><a href="https://github.com/carrierwaveuploader/carrierwave">[GitHub] carrierwave</a></p>

<p><section class="ads">
<div class="amzimg"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4774146633/lunchub-22/" rel="nofollow" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51%2BUj1CI5tL._SX280_CR0,0,280,230_.jpg" alt="Ruby on Rails 3 アプリケーションプログラミング" /></a></div>

<div class="amzimg"><a href="http://www.amazon.co.jp/exec/obidos/ASIN/4797363827/lunchub-22/" rel="nofollow" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51hvKPIWmdL._SX280_CR2,75,278,230_.jpg" alt="Rails3レシピブック 190の技" /></a></div>

</section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AWSのアクセス情報を確認する方法]]></title>
    <link href="http://lunchub.github.io/blog/2013/07/14/how-to-confirm-aws-access-information/"/>
    <updated>2013-07-14T15:25:00+09:00</updated>
    <id>http://lunchub.github.io/blog/2013/07/14/how-to-confirm-aws-access-information</id>
    <content type="html"><![CDATA[<h2>Scribble</h2>

<ul>
<li><code>AWS Management Console</code>にサインインし，ページ右上のメニューから<code>Security Credentials</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-15-24-27.jpg"><img src="/images/posts/2013/07/2013-07-14-15-24-27.jpg" alt="AWS アクセス情報確認 step1" /></a></p>

<ul>
<li><code>Access Keys</code>を開き，<code>Create New Root Key</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-15-42-34.jpg"><img src="/images/posts/2013/07/2013-07-14-15-42-34.jpg" alt="AWS アクセス情報確認 step2" /></a></p>

<p><a href="/images/posts/2013/07/2013-07-14-15-44-10.jpg"><img src="/images/posts/2013/07/2013-07-14-15-44-10.jpg" alt="AWS アクセス情報確認 step3" /></a></p>

<ul>
<li>ポップアップウインドウが開き，キーファイルをダウンロードするよう求められるので，ダウンロードする

<ul>
<li>ここでダウンロードしないと，後からシークレットアクセスキーを確認しようと思っても出来ない</li>
<li>ダウンロードしたファイルは厳重に管理する</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-16-14-10.jpg"><img src="/images/posts/2013/07/2013-07-14-16-14-10.jpg" alt="AWS アクセス情報確認 step4" /></a></p>

<p><section class="ads">
</section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Amazon S3にBucket（ストレージ）を作成する方法]]></title>
    <link href="http://lunchub.github.io/blog/2013/07/14/how-to-create-bucket-on-amazon-s3/"/>
    <updated>2013-07-14T13:24:00+09:00</updated>
    <id>http://lunchub.github.io/blog/2013/07/14/how-to-create-bucket-on-amazon-s3</id>
    <content type="html"><![CDATA[<h2>Precondition</h2>

<p><code>Amazon S3</code>を利用するためには，<code>Amazon Web Services (AWS)</code>への登録が必要です．</p>

<p><a href="/blog/2013/07/13/how-to-register-for-aws/">AWSへの登録記事はこちら</a></p>

<h2>How to</h2>

<ul>
<li><p><a href="https://console.aws.amazon.com/console/home">AWS Management Console</a>にアクセスする</p></li>
<li><p><code>S3</code>を選択する</p></li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-13-35-24.jpg"><img src="/images/posts/2013/07/2013-07-14-13-35-24.jpg" alt="S3 を選択する" /></a></p>

<ul>
<li><code>Create Bucket</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-13-38-30.jpg"><img src="/images/posts/2013/07/2013-07-14-13-38-30.jpg" alt="Create Bucket Button" /></a></p>

<ul>
<li>ポップアップパネルが開くので，作成したいBucketの名前と，リージョンを選択する

<ul>
<li>ここでは<code>Tokyo</code>リージョンを選択</li>
<li><code>Create</code>をクリックする</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-13-40-09.jpg"><img src="/images/posts/2013/07/2013-07-14-13-40-09.jpg" alt="Create Bucket PopUp" /></a></p>

<ul>
<li>作成に成功すると，Bucketの一覧画面へ遷移する

<ul>
<li>今作成したBucketが表示されていることがわかる</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-14-13-45-28.jpg"><img src="/images/posts/2013/07/2013-07-14-13-45-28.jpg" alt="" /></a></p>

<h2>Recommended</h2>

<ul>
<li><code>Rails</code> + <code>Carrierwave</code> でアップロード先を<code>Amazon S3</code>に設定したい

<ul>
<li><a href="/blog/2013/07/14/how-to-use-carrierwave-with-amazon-s3">CarrierWaveでアップロード先をAmazon S3に設定する方法</a></li>
</ul>
</li>
</ul>


<p><section class="ads">
</section></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AWSに会員登録する方法]]></title>
    <link href="http://lunchub.github.io/blog/2013/07/13/how-to-register-for-aws/"/>
    <updated>2013-07-13T18:33:00+09:00</updated>
    <id>http://lunchub.github.io/blog/2013/07/13/how-to-register-for-aws</id>
    <content type="html"><![CDATA[<h2>How to</h2>

<ul>
<li><a href="http://aws.amazon.com/jp/">http://aws.amazon.com/jp/</a>にアクセスする</li>
<li><code>サインアップ</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-18-41-34.jpg"><img src="/images/posts/2013/07/2013-07-13-18-41-34.jpg" alt="AWS サインアップ step1" /></a></p>

<ul>
<li>メールアドレスを入力して，新規ユーザを選択する</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-18-48-29.jpg"><img src="/images/posts/2013/07/2013-07-13-18-48-29.jpg" alt="AWS サインアップ step2" /></a></p>

<ul>
<li>ユーザ名とパスワードを入力する</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-18-53-14.jpg"><img src="/images/posts/2013/07/2013-07-13-18-53-14.jpg" alt="AWS サインアップ step3" /></a></p>

<ul>
<li>住所情報を入力する

<ul>
<li>しかしハマるのがここ．郵便番号を３桁で入力しないとバリデーションエラーのループから抜け出せなくなる・・・ｗ</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-04-07.jpg"><img src="/images/posts/2013/07/2013-07-13-19-04-07.jpg" alt="AWS サインアップ step4" /></a></p>

<ul>
<li>クレジットカード情報を入力する

<ul>
<li>請求先が先程入力した住所と同じであればラジオボタンはこのまま</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-26-31.jpg"><img src="/images/posts/2013/07/2013-07-13-19-26-31.jpg" alt="AWS サインアップ step5" /></a></p>

<ul>
<li>本人確認を電話で行う必要があるので，<code>Japan</code>を選択して<code>Call Me Now</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-29-20.jpg"><img src="/images/posts/2013/07/2013-07-13-19-29-20.jpg" alt="AWS サインアップ step6" /></a></p>

<ul>
<li><p>自動音声の電話がかかってきたら，画面に表示されている<code>PINコード</code>を電話のキーパッドで入力する</p></li>
<li><p>サクセスなんちゃらバイバイ〜と言われたら画面も自動的に切り替わるので先へ進む</p></li>
<li><p>サポートプランを選択する画面になるので，適宜選択する</p>

<ul>
<li>私は個人用途なので<code>Basic (Free)</code>を選択</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-34-54.jpg"><img src="/images/posts/2013/07/2013-07-13-19-34-54.jpg" alt="AWS サインアップ step7" /></a></p>

<ul>
<li>この画面が表示されれば登録は完了！

<ul>
<li><code>Your AWS Account is Ready - Get Started Now</code>といったタイトルのメールが届きます</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-37-58.jpg"><img src="/images/posts/2013/07/2013-07-13-19-37-58.jpg" alt="AWS サインアップ step8" /></a></p>

<h3>続けて<code>Amazon S3</code>等のサービスを追加したい場合</h3>

<ul>
<li><a href="http://aws.amazon.com/jp/">http://aws.amazon.com/jp/</a>にアクセスする</li>
<li><code>アカウント / コンソール</code>から<code>AWS Management Console</code>をクリックする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-46-17.jpg"><img src="/images/posts/2013/07/2013-07-13-19-46-17.jpg" alt="AWS サービス追加 step1" /></a></p>

<ul>
<li>サインイン画面に遷移するので，<code>I am a returning user and my password is</code>にチェックが入っていることを確認してパスワードを入力し，サインインする</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-49-59.jpg"><img src="/images/posts/2013/07/2013-07-13-19-49-59.jpg" alt="AWS サービス追加 step2" /></a></p>

<ul>
<li>以下のような管理画面が表示されるので，追加したいサービスを選択する</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-19-53-37.jpg"><img src="/images/posts/2013/07/2013-07-13-19-53-37.jpg" alt="AWS サービス追加 step3" /></a></p>

<h3>サービス追加の際注意すべき点</h3>

<ul>
<li>管理画面右上に表示されている<code>Global</code>というプルダウンで，リージョンの選択ができるサービス（Amazon EC2等）は，
できるだけ<code>Asia Pacific (Tokyo)</code>を選択したほうがいいと思います

<ul>
<li>リージョンとは，AWSのサーバが置かれている場所です</li>
<li>サーバとの物理的な距離が離れているほど，レスポンスが悪化するので・・</li>
</ul>
</li>
</ul>


<p><a href="/images/posts/2013/07/2013-07-13-20-00-11.jpg"><img src="/images/posts/2013/07/2013-07-13-20-00-11.jpg" alt="AWS サービス追加 注意点" /></a></p>

<p><section class="ads">
</section></p>
]]></content>
  </entry>
  
</feed>
